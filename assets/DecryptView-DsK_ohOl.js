import{u as N,a as h,b as S,c as _,d as c,e as i,f as d,g as b,B as f,S as F,N as x,h as I,i as M,r as w,l as K}from"./funcs-Cz7HNSU9.js";import{d as B,r as R,c as m,b as t,w as a,u as l,F as y,o as v,N as V,e as s,f as G,h as C,i as g,t as k}from"./index-De-B-3vi.js";import{N as T}from"./Space-BLjFd29D.js";const U={style:{"white-space":"nowrap","font-family":"v-mono, SFMono-Regular, Menlo, Consolas, Courier, monospace"}},L=B({__name:"DecryptView",setup($){const p=N(),u=h(),r=R({plaintext:"",ciphertext:u.ciphertext,key:u.key});class n{static updateCiphertext(){u.setCiphertext(r.value.ciphertext)}static updateKey(){u.setKey(r.value.key)}static resetForm(){r.value.plaintext="",r.value.ciphertext="",r.value.key="",p.success("已重置")}static reverseKey(e){try{return w(e)}catch{return p.error("密钥逆置换失败，密钥必须由 26 个小写字母组成"),e}}static handleSelect(e){switch(e){case"reverse-key":r.value.key=n.reverseKey(r.value.key);break}n.updateKey()}static decrypt(){try{const e=K(r.value.ciphertext,r.value.key);r.value.plaintext=e,u.setPlaintext(e)}catch{p.error("解密失败，请检查密钥和密文是否匹配")}}}return(P,e)=>(v(),m(y,null,[t(l(x),null,{default:a(()=>[t(l(S),{ref:"formRef",model:r.value,size:"large","label-placement":"top"},{default:a(()=>[t(l(_),{cols:"4","item-responsive":"",responsive:"screen","x-gap":18},{default:a(()=>[t(l(c),{span:"4 m:4 l:2"},{default:a(()=>[t(l(i),{label:"密文",path:"ciphertext"},{default:a(()=>[t(l(d),{value:r.value.ciphertext,"onUpdate:value":e[0]||(e[0]=o=>r.value.ciphertext=o),type:"textarea",rows:"8",placeholder:"请输入密文",onInput:n.updateCiphertext,style:{"font-family":"v-mono, SFMono-Regular, Menlo, Consolas, Courier, monospace"}},null,8,["value","onInput"])]),_:1})]),_:1}),t(l(c),{span:"4 m:4 l:2"},{default:a(()=>[t(l(i),{label:"明文",path:"plaintext"},{default:a(()=>[t(l(d),{value:r.value.plaintext,"onUpdate:value":e[1]||(e[1]=o=>r.value.plaintext=o),type:"textarea",rows:"8",placeholder:"解密的明文",style:{"font-family":"v-mono, SFMono-Regular, Menlo, Consolas, Courier, monospace"},readonly:""},null,8,["value"])]),_:1})]),_:1})]),_:1}),t(l(i),{label:"密钥",path:"key"},{default:a(()=>[t(l(b),null,{default:a(()=>[t(l(d),{value:r.value.key,"onUpdate:value":e[2]||(e[2]=o=>r.value.key=o),placeholder:"请输入由 26 个小写字母组成的密钥(必须与加密时的密钥一致)",onInput:n.updateKey,style:{"font-family":"v-mono, SFMono-Regular, Menlo, Consolas, Courier, monospace"}},null,8,["value","onInput"]),t(l(V),{trigger:"hover"},{trigger:a(()=>[t(l(f),{strong:"",secondary:"",onClick:e[3]||(e[3]=o=>n.handleSelect("reverse-key"))},{default:a(()=>[t(l(G),null,{default:a(()=>[t(l(F))]),_:1})]),_:1})]),default:a(()=>[e[6]||(e[6]=s("span",null,"逆置换密钥",-1))]),_:1,__:[6]})]),_:1})]),_:1}),t(l(T),null,{default:a(()=>[t(l(f),{type:"error",onClick:e[4]||(e[4]=o=>n.decrypt())},{default:a(()=>e[7]||(e[7]=[C("解密")])),_:1,__:[7]}),t(l(f),{type:"info",onClick:e[5]||(e[5]=o=>n.resetForm())},{default:a(()=>e[8]||(e[8]=[C("重置")])),_:1,__:[8]})]),_:1})]),_:1},8,["model"])]),_:1}),t(l(x),{title:"密钥映射关系",style:{"margin-top":"30px"}},{default:a(()=>[t(l(I),{"x-scrollable":""},{default:a(()=>[s("div",U,[t(l(M),{"single-column":""},{default:a(()=>[s("thead",null,[s("tr",null,[(v(),m(y,null,g(26,o=>s("th",{key:o},k(String.fromCharCode(o+96)),1)),64))])]),s("tbody",null,[s("tr",null,[(v(),m(y,null,g(26,o=>s("td",{key:o},k(r.value.key[o-1]||String.fromCharCode(o+96)),1)),64))])])]),_:1})])]),_:1})]),_:1})],64))}});export{L as default};
